
	<!-- main content -->
<!--	<main class="main">-->
		<div class="container">
			<div class="row">
				<!-- 主体 -->
				<div class="col-12 col-md-7 col-lg-8 col-xl-9">
					<div id="postContainer">
						<!-- post -->
						<div class="post">

							<div class="post__description">
								<p>
									抱歉，未搜索到相关文章...
								</p>
							</div>

						</div>
						<!-- end post -->
					</div>

					<!-- view more -->
					<button class="main__btn" type="button" onclick="searchByKeywords()"><span>加载更多</span></button>
					<!-- end view more -->
				</div>

				<!-- 右边栏 -->
				<div class="col-12 col-md-5 col-lg-4 col-xl-3">
					<!-- sidebox -->
					<div class="sidebox sidebox--desk">
						<h4 class="sidebox__title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">阅读最多</font></font></h4>
						<div class="sidebox__content full-height-scroll" id="readMostContainer" style="height: 301px; overflow-y: scroll">
							<div class="sidebox__job">
								<div class="sidebox__job-title">
									<a href="#"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UI / UX Designer </font></font></a>
									<span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3天前</font></font></span>
								</div>
								<p class="sidebox__job-description"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">因此，生成的Lorem Ipsum始终没有重复。
								</font></font></p>
							</div>

							<div class="sidebox__job">
								<div class="sidebox__job-title">
									<a href="#"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">后端开发人员</font></font></a>
									<span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3天前</font></font></span>
								</div>
								<p class="sidebox__job-description"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">因此，生成的Lorem Ipsum始终没有重复。
								</font></font></p>
							</div>

							<div class="sidebox__job">
								<div class="sidebox__job-title">
									<a href="#"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">高级Java开发人员</font></font></a>
									<span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3天前</font></font></span>
								</div>
								<p class="sidebox__job-description"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">因此，生成的Lorem Ipsum始终没有重复。
								</font></font></p>
							</div>

							<div class="sidebox__job">
								<div class="sidebox__job-title">
									<a href="#"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">高级Java开发人员</font></font></a>
									<span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3天前</font></font></span>
								</div>
								<p class="sidebox__job-description"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">因此，生成的Lorem Ipsum始终没有重复。
								</font></font></p>
							</div>

							<div class="sidebox__job">
								<div class="sidebox__job-title">
									<a href="#"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">高级Java开发人员</font></font></a>
									<span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3天前</font></font></span>
								</div>
								<p class="sidebox__job-description"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">因此，生成的Lorem Ipsum始终没有重复。
								</font></font></p>
							</div>
						</div>
						<!--						<a href="#" class="sidebox__more"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">查看更多</font></font></a>-->
					</div>
					<!-- end sidebox -->


					<!-- sidebox -->
					<div class="sidebox sidebox--desk">
						<h4 class="sidebox__title">点赞最多</h4>
						<div class="sidebox__content full-height-scroll" id="likeMostContainer" style="height: 301px; overflow-y: scroll">
							<div class="sidebox__job">
								<div class="sidebox__job-title">
									<a href="#"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">前端开发人员</font></font></a>
									<span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3天前</font></font></span>
								</div>
								<p class="sidebox__job-description">因此，生成的Lorem Ipsum始终没有重复。</p>
							</div>

							<div class="sidebox__job">
								<div class="sidebox__job-title">
									<a href="#"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UI / UX Designer </font></font></a>
									<span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3天前</font></font></span>
								</div>
								<p class="sidebox__job-description"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">因此，生成的Lorem Ipsum始终没有重复。
								</font></font></p>
							</div>

							<div class="sidebox__job">
								<div class="sidebox__job-title">
									<a href="#"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">后端开发人员</font></font></a>
									<span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3天前</font></font></span>
								</div>
								<p class="sidebox__job-description"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">因此，生成的Lorem Ipsum始终没有重复。
								</font></font></p>
							</div>

							<div class="sidebox__job">
								<div class="sidebox__job-title">
									<a href="#"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">领队</font></font></a>
									<span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3天前</font></font></span>
								</div>
								<p class="sidebox__job-description"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">因此，生成的Lorem Ipsum始终没有重复。
								</font></font></p>
							</div>

							<div class="sidebox__job">
								<div class="sidebox__job-title">
									<a href="#"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">高级Java开发人员</font></font></a>
									<span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3天前</font></font></span>
								</div>
								<p class="sidebox__job-description"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">因此，生成的Lorem Ipsum始终没有重复。
								</font></font></p>
							</div>

							<div class="sidebox__job">
								<div class="sidebox__job-title">
									<a href="#"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">高级Java开发人员</font></font></a>
									<span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3天前</font></font></span>
								</div>
								<p class="sidebox__job-description"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">因此，生成的Lorem Ipsum始终没有重复。
								</font></font></p>
							</div>

							<div class="sidebox__job">
								<div class="sidebox__job-title">
									<a href="#"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">高级Java开发人员</font></font></a>
									<span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3天前</font></font></span>
								</div>
								<p class="sidebox__job-description"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">因此，生成的Lorem Ipsum始终没有重复。
								</font></font></p>
							</div>
						</div>
						<!--						<a href="#" class="sidebox__more"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">查看更多</font></font></a>-->
					</div>
					<!-- end sidebox -->


					<!-- sidebox -->
					<div class="sidebox sidebox--desk">
						<h4 class="sidebox__title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最近评论</font></font></h4>
						<div class="sidebox__content full-height-scroll" id="recentCommentsContainer" style="height: 332px; overflow-y: scroll; padding-right: 5px;">
							<div class="sidebox__user">
								<a href="#" class="sidebox__user-img">
									<img src="img/user3.jpg" alt="">
								</a>
								<div class="sidebox__user-title">
									<h5><a href="#"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">玛莎·鲍德温（Marsha Baldwin）</font></font></a></h5>
									<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">秘书</font></font></p>
								</div>
							</div>

							<div class="sidebox__user">
								<a href="#" class="sidebox__user-img">
									<img src="img/user3.jpg" alt="">
								</a>
								<div class="sidebox__user-title">
									<h5><a href="#"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">玛莎·鲍德温（Marsha Baldwin）</font></font></a></h5>
									<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">秘书</font></font></p>
								</div>
							</div>

							<div class="sidebox__user">
								<a href="#" class="sidebox__user-img">
									<img src="img/user3.jpg" alt="">
								</a>
								<div class="sidebox__user-title">
									<h5><a href="#"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">玛莎·鲍德温（Marsha Baldwin）</font></font></a></h5>
									<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">秘书</font></font></p>
								</div>
							</div>

							<div class="sidebox__user">
								<a href="#" class="sidebox__user-img">
									<img src="img/user3.jpg" alt="">
								</a>
								<div class="sidebox__user-title">
									<h5><a href="#"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">玛莎·鲍德温（Marsha Baldwin）</font></font></a></h5>
									<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">秘书</font></font></p>
								</div>
							</div>

							<div class="sidebox__user">
								<a href="#" class="sidebox__user-img">
									<img src="img/user2.jpg" alt="">
								</a>
								<div class="sidebox__user-title">
									<h5><a href="#"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">托尼·杨</font></font></a></h5>
									<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">中医师</font></font></p>
								</div>
							</div>

							<div class="sidebox__user">
								<a href="#" class="sidebox__user-img">
									<img src="img/user9.jpg" alt="">
								</a>
								<div class="sidebox__user-title">
									<h5><a href="#"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">圣地亚哥·罗宾逊</font></font></a></h5>
									<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">时装设计师</font></font></p>
								</div>
							</div>

							<div class="sidebox__user">
								<a href="#" class="sidebox__user-img">
									<img src="img/user4.jpg" alt="">
								</a>
								<div class="sidebox__user-title">
									<h5><a href="#"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">索菲亚·门多萨（Sophia）</font></font></a></h5>
									<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">教学助手</font></font></p>
								</div>
							</div>

							<div class="sidebox__user">
								<a href="#" class="sidebox__user-img">
									<img src="img/user6.jpg" alt="">
								</a>
								<div class="sidebox__user-title">
									<h5><a href="#"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">玛莎·鲍德温（Marsha Baldwin）</font></font></a></h5>
									<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">园丁</font></font></p>
								</div>
							</div>
						</div>
						<!--						<a href="#" class="sidebox__more"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">查看更多</font></font></a>-->
					</div>
					<!-- end sidebox -->
				</div>
			</div>
		</div>
<!--	</main>-->
	<!-- end main content -->



<script>
	var global_currentPage=1;
	var global_pageSize=10;
	var global_totalPages=1;
	var global_hasLoadHistory=false; //标志是否加载过

	var auth_domain = getConfig('auth_domain');
	var base_domain = getConfig('base_domain');

	$('.index-top-menu').removeClass('top-menu-bg-color');

	//中间-文章列表
	searchByKeywords();

	//右侧栏
	findLikeMost();
	findReadMost();
	getRecentComments();

	var clipboard = new ClipboardJS('.copy-link', {
		text: function(trigger) {
			layer.msg('复制成功！');
			return base_domain+"/spartacus-sunday/article.html?articleId="+trigger.getAttribute('article-id');
		}
	});

	function share(ele) {
		var articleId = $(ele).attr('article-id');
		var url=base_domain+"/spartacus-sunday/article.html?articleId="+articleId;
		var index = layer.open({
			height: '210px',
			type: 1,
			title: false,
			closeBtn: 0,
			area: ['auto'],
			skin: 'layui-layer-nobg', //没有背景色
			shadeClose: true,
			content: '<div align="center" style="width: 180px; height: 205px; background-color: #FFFFFF; align-content: center"><img style="margin: 15px 15px 10px 15px;" src="https://api.qrserver.com/v1/create-qr-code?size=150x150&data='+url+'"><br><span style="font-size: 10">微信扫一扫，分享到朋友圈</span></div>'
		});
	}

	function like(ele) {
		var jwt = JSON.parse(localStorage.getItem('social-jwt') || '[]');
		if($.isEmptyObject(jwt)) {
			parent.layer.msg('您还没有登录哦！');
			return;
		}

		$.ajax({
			type : "POST",
			url : base_domain+"/spartacus-article/articleLike/like",
			async : true,
			data : { //使用Json格式进行透传
				"articleId" : $(ele).attr("article-id"),
				"userSequence" : jwt.userSequence
			},
			dataType:"json",
			headers: {
				"clientId":"spartacus-sunday",
				"clientCurrentId":getClientCurrentId(),
				"Authorization":"bearer " + jwt.access_token//自定义请求头
			},
			success : function(result) {
				if (result.code==200) {
					var likeNum = parseInt($("#like_number_"+$(ele).attr("article-id")).text());
					$("#like_number_"+$(ele).attr("article-id")).text(likeNum+1);
					$("#icon_like_"+$(ele).attr("article-id")).addClass("like-status-bgcolor");

					$("#btn_like_"+$(ele).attr("article-id")).attr('onclick', 'unLike(this)');
				}
			}
		});
	}

	function unLike(ele) {
		var jwt = JSON.parse(localStorage.getItem('social-jwt') || '[]');
		if($.isEmptyObject(jwt)) {
			parent.layer.msg('您还没有登录哦！');
			return;
		}

		$.ajax({
			type : "POST",
			url : base_domain+"/spartacus-article/articleLike/unLike",
			async : true,
			data : { //使用Json格式进行透传
				"articleId" : $(ele).attr("article-id"),
				"userSequence" : jwt.userSequence
			},
			dataType:"json",
			headers: {
				"clientId":"spartacus-sunday",
				"clientCurrentId":getClientCurrentId(),
				"Authorization":"bearer " + jwt.access_token//自定义请求头
			},
			success : function(result) {
				if (result.code==200) {
					var likeNum = parseInt($("#like_number_"+$(ele).attr("article-id")).text());
					$("#like_number_"+$(ele).attr("article-id")).text(likeNum-1);
					$("#icon_like_"+$(ele).attr("article-id")).removeClass("like-status-bgcolor");

					$("#btn_like_"+$(ele).attr("article-id")).attr('onclick', 'like(this)');
				}
			}
		});
	}

	function checkMulLikeMember(articles) {
		var jwt = JSON.parse(localStorage.getItem('social-jwt') || '[]');

		if(!isNullOrEmpty(jwt.providerUserId)) {
			var articleLikes = new Array();
			for(var i = 0; i < articles.length; i++) {
				articleLikes.push({articleId: articles[i].id, status: 0, userSequence: jwt.userSequence});
			}

			$.ajax({
				type : "POST",
				url : base_domain+"/spartacus-article/articleLike/checkMulLikeMember",
				async : true,
				data : JSON.stringify(articleLikes),
				dataType:"json",
				contentType : "application/json", //必须设置请求头
				headers: {
					"clientId":"spartacus-sunday",
					"clientCurrentId":getClientCurrentId(),
					"Authorization":"bearer " + jwt.access_token//自定义请求头
				},
				success : function(result) {
					if (result.code==200) {
						var respArticleLikes = result.data;
						for(var i = 0; i < respArticleLikes.length; i++) {
							if(respArticleLikes[i].status == 1) {
								$("#btn_like_"+respArticleLikes[i].articleId).attr('onclick', 'unLike(this)');
								$("#icon_like_"+respArticleLikes[i].articleId).addClass('like-status-bgcolor');
							}
						}
					}
				}
			});
		}
	}

	function searchByKeywords() {
		if(global_currentPage > global_totalPages) {
			parent.layer.msg("已经加载完啦", function(){});
			return;
		}

		var searchContent = $("#search_input_id").val();
		if(!$.trim(searchContent)){ // "",null,undefined
			parent.layer.msg('搜索内容不能为空！', function () {});
			$("#search_input_id").val("");
			$("#search_input_id").focus();
			return;
		} else {
			$.ajax({
				type : "POST",
				url : base_domain+"/spartacus-article/article/searchByKeywords",
				async : true,
				data : { //使用Json格式进行透传
					"searchText" : searchContent,
					"currentPage" : global_currentPage,
					"pageSize" : global_pageSize
				},
				dataType:"json",
				headers: {
					"clientId":"spartacus-sunday",
					"clientCurrentId":getClientCurrentId()
				},
				success : function(result) {
					if (result.code==0) {
						var articles = result.data.records;

						if(!global_hasLoadHistory) {
							if(!$.isEmptyObject(articles)) {
								$("#postContainer").children().remove();
							}
						}

						for(var i = 0; i < articles.length; i++) {
							var id = articles[i]['id'];
							var author = articles[i]['author'];
							var brief = articles[i]['brief'];
							var cname = articles[i]['cname'];
							var likeNumber = articles[i]['likeNumber'];
							var commentNumber = articles[i]['commentNumber'];
							var fromWhere = articles[i]['fromWhere'];
							var isTop = articles[i]['isTop'];
							var labels = articles[i]['labels'];
							var monthDay = articles[i]['monthDay'];
							var pictures = [];
							if(!isNullOrEmpty(articles[i].pictures)) {
								pictures = articles[i].pictures.split(";");
							}
							var publishTime = articles[i]['publishTime'];
							var scanNumber = articles[i]['scanNumber'];
							var status = articles[i]['status'];
							var title = articles[i]['title'];
							var year = articles[i]['year'];

							var labelHtml = '';
							if(labels != null && labels !='') {
								var labelArray = labels.split(',');
								for(var j = 0; j < labelArray.length; j++) {
									labelHtml += "<a style='cursor: default;' href='#'>"+labelArray[j]+"</a>";
								}
							}

							$("#postContainer").append("<div class='post'><div class='post__head'><a target='_blank' href='article.html?articleId="+id+"' article-id="+id+"><h2 class='post__title'>"+title+"</h2></a><div class='post__dropdown'><a class='dropdown-toggle post__dropdown-btn'href='#'role='button'id='dropdownMenu_"+id+"'data-toggle='dropdown'aria-haspopup='true'aria-expanded='false'><i class='icon ion-md-more'></i></a><ul class='dropdown-menu dropdown-menu-right post__dropdown-menu' aria-labelledby='dropdownMenu_"+id+"'><li><a class='copy-link' href='javascript:void(0);' article-id='"+id+"'>复制链接</a></li><li><a href='javascript:void(0);' onclick='share(this)' article-id='"+id+"'>分享至朋友圈</a></li></ul></div></div><div class='post__wrap'><div class='post__company'><i class='icon ion-ios-person-add'></i><span><font style='vertical-align: inherit;'><font style='vertical-align: inherit;'>"+author+"</font></font></span></div><div class='post__location'><i class='icon ion-ios-time'></i><span><font style='vertical-align: inherit;'><font style='vertical-align: inherit;'>"+millisecondsToLocalDate(publishTime)+"</font></font></span></div></div><div class='post__description'><p style='overflow: hidden;-webkit-line-clamp: 3;display:-webkit-box;-webkit-box-orient: vertical;'>"+brief+"</p><a target='_blank' href='article.html?articleId="+id+"' article-id="+id+">查看更多</a></div><div class='post__tags'>"+labelHtml+"</div><div class='post__stats'><div><a id='btn_like_"+id+"' class='post__likes' href='javascript:void(0);' onclick='like(this)' article-id="+id+"><i id='icon_like_"+id+"' class='icon ion-ios-heart'></i><span id='like_number_"+id+"'>"+likeNumber+"</span></a><a style='cursor: default;' class='post__comments' data-toggle='collapse'href='#collapse_"+id+"'role='button'aria-expanded='false'aria-controls='collapse_"+id+"'><i class='icon ion-ios-text'></i><span>"+commentNumber+"</span></a></div><div class='post__views'><i class='icon ion-ios-eye'></i><span>"+scanNumber+"</span></div></div></div>");
						}

						checkMulLikeMember(articles);

						global_totalPages = result.data.totalPages;
						global_currentPage += 1;
						global_hasLoadHistory = true;

					} else {
						parent.layer.msg(result.message, {
							icon: 2,
							time:1000
						});
					}
				},
				error: function (xhr, status, error) {
					layer.msg("搜索文章失败！", {
						icon: 2,
						time:1000
					});
				}
			});
		}
	}
</script>
